# Go-разработчик (зима 2024) - Экзамен по программированию

## 6. Array

| Показатель           | значение                   |
|----------------------|----------------------------|
| Ограничение времени  | 1 секунда                  |
| Ограничение памяти   | 256Mb                      |
| Ввод                 | стандартный ввод (stdin)   |
| Вывод                | стандартный вывод (stdout) |

Поздравляю, вы дошли до серьёзной задачи, больше никаких легенд, только хардкор.

Дан массив `a` из `n` целых чисел. Требуется выполнить `q` запросов такого вида `(1 ≤ l ≤ r ≤ n, 0 ≤ k, b, x ≤ 10^9)`:

- `+ l r x` — прибавить `x` ко всем `ai` на отрезке `i∈[l,r]`
- `? l r k b` — вывести `max l ≤ i ≤ r min (ai, k * i+b)`

**Формат входных данных**

В первой строке заданы два числа `n`, `q` `(1 ≤ n ≤ 2 * 10^5, 1 ≤ q ≤ 5 * 10^5)`.

Во второй строке задан массив `a ( 0 ≤ ai ≤ 10^9)`.

Следующие `q` строк содержат запросы в заданном формате. Гарантируется, что будет хотя бы один запрос типа `?`.

**Формат выходных данных**

Для каждого запроса типа ? выведите ответ в отдельной строке.

#### Пример 1

Ввод:
6 3
2 4 6 8 10 12
? 2 5 3 0
`+ 2 3 6
? 2 5 3 2

Вывод:
10
11
